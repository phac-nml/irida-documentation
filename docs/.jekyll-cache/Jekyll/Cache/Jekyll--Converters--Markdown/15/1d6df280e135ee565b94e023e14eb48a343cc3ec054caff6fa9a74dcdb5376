I"ì<h1 id="irida-whole-genome-phylogenomics">IRIDA Whole Genome Phylogenomics</h1>

<p>IRIDA uses the software <a href="http://snvphyl.readthedocs.io">SNVPhyl</a> for constructing whole genome phylogenies.  The following table lists the dependency tools required by the software.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Tool Name</th>
      <th style="text-align: center">Tool Revision</th>
      <th style="text-align: center">Toolshed Installable Revision</th>
      <th style="text-align: center">Toolshed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><strong>suite_snvphyl_1_2_2</strong></td>
      <td style="text-align: center"><a href="https://toolshed.g2.bx.psu.edu/view/nml/suite_snvphyl_1_2_2/77a9422303ce">77a9422303ce</a></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center"><a href="http://toolshed.g2.bx.psu.edu/">Galaxy Main Shed</a></td>
    </tr>
  </tbody>
</table>

<p>To install these tools, please proceed through the following steps.</p>

<h2 id="step-1-install-galaxy-tools">Step 1: Install Galaxy Tools</h2>

<p>Please install all the Galaxy tools in the table above by logging into Galaxy, navigating to <strong>Admin &gt; Search and browse tool sheds</strong>, searching for the appropriate <strong>Tool Name</strong> and installing the appropriate <strong>Toolshed Installable Revision</strong>.</p>

<p>The install progress can be monitored in the Galaxy log files <code>galaxy/*.log</code>.  On completion you should see a message of <code>Installed</code> next to the tool when going to <strong>Admin &gt; Manage installed tool shed repositories</strong>.</p>

<h2 id="step-2-testing-pipeline">Step 2: Testing Pipeline</h2>

<p>A Galaxy workflow and some test data has been included with this documentation to verify that all tools are installed correctly.  To test this pipeline, please proceed through the following steps.</p>

<ol>
  <li>Upload the <a href="../test/snvphyl/snvphyl_workflow.ga">SNVPhyl Galaxy Workflow</a> by going to <strong>Workflow &gt; Upload or import workflow</strong>.</li>
  <li>Upload a reference genome by going to <strong>Analyze Data</strong> and then clicking on the <strong>upload files from disk</strong> <img src="../test/snvphyl/images/upload-icon.jpg" alt="upload-icon" /> icon in the <strong>Tools</strong> panel.  Select the <a href="../test/snvphyl/reference.fasta">pipelines/test/snvphyl/reference.fasta</a> file.</li>
  <li>
    <p>Upload the sequence reads by going to <strong>Analyze Data</strong> and then clicking on the <strong>upload files from disk</strong>.  Select the <a href="../test/snvphyl/reads">pipelines/test/snvphyl/reads</a> files.  Make sure to change the <strong>Type</strong> of each file from <strong>Auto-detect</strong> to <strong>fastqsanger</strong>.  When uploaded you should see the following in your history.</p>

    <p><img src="../test/snvphyl/images/upload-history.jpg" alt="upload-history" /></p>
  </li>
  <li>
    <p>Construct a dataset collection of the paired-end reads by clicking the <strong>Operations on multiple datasets</strong> icon <img src="../test/snvphyl/images/datasets-icon.jpg" alt="datasets-icon" />.  Please check off all the <strong>.fastq</strong> files and then go to <strong>For all selectedâ€¦ &gt; Build List of dataset pairs</strong>.  You should see a screen that looks as follows.</p>

    <p><img src="../test/snvphyl/images/dataset-pair-screen.jpg" alt="dataset-pair-screen" /></p>
  </li>
  <li>This should have properly paired your data and named each sample <strong>a</strong>, <strong>b</strong>, and <strong>c</strong>.  Enter the name of this paired dataset collection at the bottom and click <strong>Create list</strong>.</li>
  <li>Run the uploaded workflow by clicking on <strong>Workflow</strong>, clicking on the name of the workflow <strong>SNVPhyl Pipeline</strong> and clicking <strong>Run</strong>.  This should auto fill in the reference file and dataset collection.  There should be three boxes for filling in runtime parameters.  Please fill in <code>min_coverage=5</code>, <code>min_mean_mapping=30</code>, and <code>snv_abundance_ratio=0.75</code>.  Now, at the very bottom of the screen click <strong>Run workflow</strong>.</li>
  <li>
    <p>If everything was installed correctly, you should see each of the tools run successfully (turn green).  On completion this should look like.</p>

    <p><img src="../test/snvphyl/images/workflow-success.png" alt="workflow-success" /></p>

    <p>If you see any tool turn red, you can click on the view details icon <img src="../test/snvphyl/images/view-details-icon.jpg" alt="view-details-icon" /> for more information.</p>
  </li>
</ol>

<p>If everything was successfull then all dependencies for this pipeline have been properly installed.</p>

:ET